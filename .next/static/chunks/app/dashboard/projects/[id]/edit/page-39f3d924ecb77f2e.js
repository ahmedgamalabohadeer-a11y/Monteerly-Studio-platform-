(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{936:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(5155),d=r(2115),o=r(3321),n=r(9229),a=r(4927);function l(){let[e,t]=(0,d.useState)({title:"",description:"",budget:0,deadline:""}),[r,l]=(0,d.useState)(!0),[s,p]=(0,d.useState)(!1),[c,u]=(0,d.useState)(""),[x,b]=(0,d.useState)(!1),g=(0,o.useRouter)(),h=(0,o.useParams)(),f=h?.id||"";(0,d.useEffect)(()=>{let e=()=>{b(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,d.useEffect)(()=>{let e=n.j2.onAuthStateChanged(async e=>{if(!e)return void g.push("/login");if(!f)return void l(!1);try{let e=(0,a.H9)(n.db,"projects",f),r=await (0,a.x7)(e);if(!r.exists())return void g.push("/dashboard/projects");let i=r.data(),d="";i.deadline&&(d=new Date(i.deadline.toMillis?i.deadline.toMillis():i.deadline).toISOString().split("T")[0]),t({title:i.title||"",description:i.description||"",budget:i.budget||0,deadline:d}),l(!1)}catch(e){console.error("خطأ في جلب المشروع:",e),l(!1)}});return()=>e()},[f,g]);let m=e=>{let{name:r,value:i}=e.target;t(e=>({...e,[r]:"budget"===r?parseFloat(i)||0:i}))},y=async t=>{if(t.preventDefault(),u(""),!e.title.trim())return void u("عنوان المشروع مطلوب");if(!e.budget||e.budget<=0)return void u("الميزانية يجب أن تكون أكبر من صفر");if(!e.deadline)return void u("تاريخ التسليم مطلوب");p(!0);try{let t=(0,a.H9)(n.db,"projects",f);await (0,a.mZ)(t,{title:e.title.trim(),description:e.description.trim(),budget:e.budget,deadline:new Date(e.deadline)}),g.push(`/dashboard/projects/${f}`)}catch(e){console.error("خطأ في تحديث المشروع:",e),u("حدث خطأ أثناء حفظ التعديلات. حاول مرة أخرى."),p(!1)}};return r?(0,i.jsx)("main",{dir:"rtl",style:{minHeight:"100vh",backgroundColor:"#020617",color:"white",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,i.jsx)("p",{children:"جاري تحميل بيانات المشروع..."})}):(0,i.jsxs)("main",{dir:"rtl",style:{minHeight:"100vh",backgroundColor:"#020617",color:"white",padding:x?"60px 12px 20px":"24px 32px"},children:[(0,i.jsxs)("header",{style:{marginBottom:x?16:20,display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:x?"20px":"24px",fontWeight:700,marginBottom:4},children:"تعديل المشروع"}),(0,i.jsx)("p",{style:{fontSize:"13px",color:"#9ca3af"},children:"قم بتحديث تفاصيل المشروع وحفظ التغييرات."})]}),(0,i.jsx)("button",{type:"button",onClick:()=>g.push(`/dashboard/projects/${f}`),style:{padding:"6px 10px",borderRadius:"999px",border:"1px solid #334155",backgroundColor:"#020617",color:"#e5e7eb",fontSize:"11px",whiteSpace:"nowrap",cursor:"pointer"},children:"← الرجوع"})]}),(0,i.jsx)("section",{style:{borderRadius:"16px",border:"1px solid rgba(31,41,55,1)",background:"linear-gradient(135deg,rgba(15,23,42,0.98),rgba(15,23,42,0.9))",padding:x?"16px":"24px",maxWidth:"600px"},children:(0,i.jsxs)("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:16},children:[c&&(0,i.jsx)("div",{style:{backgroundColor:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.5)",borderRadius:"12px",padding:"12px"},children:(0,i.jsxs)("p",{style:{fontSize:"12px",color:"#fca5a5",margin:0},children:["⚠️ ",c]})}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,i.jsx)("label",{htmlFor:"title",style:{fontSize:"12px",fontWeight:600,color:"#e5e7eb"},children:"عنوان المشروع *"}),(0,i.jsx)("input",{id:"title",type:"text",name:"title",value:e.title,onChange:m,placeholder:"عنوان المشروع",style:{width:"100%",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(31,41,55,1)",backgroundColor:"rgba(15,23,42,0.95)",color:"#e5e7eb",fontSize:"13px",fontFamily:"inherit"}})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,i.jsx)("label",{htmlFor:"description",style:{fontSize:"12px",fontWeight:600,color:"#e5e7eb"},children:"وصف المشروع (اختياري)"}),(0,i.jsx)("textarea",{id:"description",name:"description",value:e.description,onChange:m,placeholder:"اشرح تفاصيل المشروع...",rows:5,style:{width:"100%",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(31,41,55,1)",backgroundColor:"rgba(15,23,42,0.95)",color:"#e5e7eb",fontSize:"13px",fontFamily:"inherit",resize:"vertical"}})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:x?"1fr":"1fr 1fr",gap:12},children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,i.jsx)("label",{htmlFor:"budget",style:{fontSize:"12px",fontWeight:600,color:"#e5e7eb"},children:"الميزانية (جنيه مصري) *"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",border:"1px solid rgba(31,41,55,1)",borderRadius:"10px",backgroundColor:"rgba(15,23,42,0.95)",overflow:"hidden"},children:[(0,i.jsx)("input",{id:"budget",type:"number",name:"budget",value:e.budget,onChange:m,placeholder:"5000",min:"0",step:"100",style:{flex:1,padding:"10px 12px",border:"none",backgroundColor:"transparent",color:"#e5e7eb",fontSize:"13px",fontFamily:"inherit"}}),(0,i.jsx)("span",{style:{padding:"10px 12px",backgroundColor:"rgba(31,41,55,0.5)",color:"#9ca3af",fontSize:"12px",fontWeight:600},children:"EGP"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,i.jsx)("label",{htmlFor:"deadline",style:{fontSize:"12px",fontWeight:600,color:"#e5e7eb"},children:"موعد التسليم *"}),(0,i.jsx)("input",{id:"deadline",type:"date",name:"deadline",value:e.deadline,onChange:m,style:{width:"100%",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(31,41,55,1)",backgroundColor:"rgba(15,23,42,0.95)",color:"#e5e7eb",fontSize:"13px",fontFamily:"inherit"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:x?"1fr":"1fr 1fr",gap:10,marginTop:8},children:[(0,i.jsx)("button",{type:"button",onClick:()=>g.push(`/dashboard/projects/${f}`),style:{padding:"10px 16px",borderRadius:"10px",border:"1px solid rgba(31,41,55,1)",backgroundColor:"#020617",color:"#e5e7eb",fontSize:"13px",fontWeight:600,cursor:"pointer"},children:"الغاء"}),(0,i.jsx)("button",{type:"submit",disabled:s,style:{padding:"10px 16px",borderRadius:"10px",border:"none",background:"linear-gradient(135deg,#0DB7B4,#22c55e,#16a34a)",color:"white",fontSize:"13px",fontWeight:600,cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:s?"جاري الحفظ...":"حفظ التعديلات"})]}),(0,i.jsx)("div",{style:{backgroundColor:"rgba(13,183,180,0.1)",border:"1px solid rgba(13,183,180,0.3)",borderRadius:"10px",padding:"10px 12px",marginTop:8},children:(0,i.jsx)("p",{style:{fontSize:"11px",color:"#a5f3fc",margin:0,lineHeight:1.5},children:'\uD83D\uDCA1 سيتم حفظ التعديلات فوراً في قاعدة البيانات عند الضغط على "حفظ التعديلات".'})})]})})]})}},978:(e,t,r)=>{Promise.resolve().then(r.bind(r,936))},9229:(e,t,r)=>{"use strict";r.d(t,{G6:()=>u,Ru:()=>c,bk:()=>p,db:()=>s,j2:()=>a,ri:()=>x});var i=r(7873),d=r(5140),o=r(4927);let n=(0,i.Dk)().length?(0,i.Sx)():(0,i.Wp)({apiKey:"AIzaSyBkQg0OpIah84-dsC3OQDKWIn1soJACFb0",authDomain:"monteerly-studio.firebaseapp.com",databaseURL:"https://monteerly-studio-default-rtdb.firebaseio.com",projectId:"monteerly-studio",storageBucket:"monteerly-studio.firebasestorage.app",messagingSenderId:"79891455687",appId:"1:79891455687:web:b7a01b2770f899e054a8e2",measurementId:"G-Y5MNPK3K4Y"}),a=(0,d.xI)(n),l=new d.HF,s=(0,o.aU)(n);async function p(e,t){let r=await (0,d.eJ)(a,e,t),i=(0,o.H9)(s,"users",r.user.uid);return await (0,o.BN)(i,{email:r.user.email,createdAt:new Date},{merge:!0}),r.user}function c(e,t){return(0,d.x9)(a,e,t)}async function u(){let e=await (0,d.df)(a,l),t=(0,o.H9)(s,"users",e.user.uid);return(await (0,o.x7)(t)).exists()||await (0,o.BN)(t,{email:e.user.email,createdAt:new Date},{merge:!0}),e.user}function x(){return(0,d.CI)(a)}}},e=>{e.O(0,[992,138,132,441,794,358],()=>e(e.s=978)),_N_E=e.O()}]);